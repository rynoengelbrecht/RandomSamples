SELECT
    w.name AS ProcessName,
    w.category,
    CASE w.category
        WHEN 0 THEN 'Classic Workflow'
        WHEN 1 THEN 'Dialog'
        WHEN 2 THEN 'Business Process Flow'
        WHEN 3 THEN 'Action'
        WHEN 4 THEN 'Business Rule'
        WHEN 5 THEN 'Power Automate (Cloud Flow)'
        ELSE 'Other'
    END AS CategoryName,
    w.primaryentity AS PrimaryEntity,
    CASE w.mode
        WHEN 0 THEN 'Background (Async)'
        WHEN 1 THEN 'Real-time (Sync)'
        ELSE 'Mode ' + CAST(w.mode AS VARCHAR(10))
    END AS ExecutionMode,
    -- Triggers (mostly meaningful for classic workflows)
    w.triggeroncreate              AS TriggerOnCreate,
    w.triggeronupdate              AS TriggerOnUpdate,
    w.triggeronupdateattributelist AS TriggerOnUpdateAttributeList,
    w.triggerondelete              AS TriggerOnDelete,
    w.triggeronassign              AS TriggerOnAssign,
    w.triggeronstatuschange        AS TriggerOnStatusChange,
    -- Useful to see who owns it
    w.owninguser,
    w.owningbusinessunit
FROM
    workflow AS w
WHERE
    w.primaryentity = 'account'
    AND w.type = 1          -- 1 = Definition (not instances)
    AND w.statecode = 1     -- 1 = Activated
    AND w.category IN (0, 5) -- 0 = classic workflow, 5 = cloud flow (Power Automate)
ORDER BY
    CategoryName,
    ExecutionMode,
    w.name;
